System.register(["valtio/vanilla","proxy-compare"],function(k){"use strict";var S,y,b,E,C,M,A;return{setters:[function(f){S=f.subscribe,y=f.snapshot,b=f.proxy,E=f.getVersion,C=f.ref},function(f){M=f.createProxy,A=f.isChanged}],execute:function(){k({addComputed:U,derive:I,devtools:H,proxyMap:X,proxySet:K,proxyWithComputed:L,proxyWithHistory:V,subscribeKey:f,underive:R,watch:W});function f(n,s,e,t){return S(n,r=>{r.some(o=>o[1][0]===s)&&e(n[s])},t)}let O;function W(n,s){let e=!0;const t=new Set,r=new Map,o=()=>{e&&(e=!1,t.forEach(i=>i()),t.clear(),r.forEach(i=>i()),r.clear())},u=()=>{if(!e)return;t.forEach(a=>a()),t.clear();const i=new Set,h=O;O=t;try{const a=n(c=>(i.add(c),c));a&&t.add(a)}finally{O=h}r.forEach((a,c)=>{i.has(c)?i.delete(c):(r.delete(c),a())}),i.forEach(a=>{const c=S(a,u,s==null?void 0:s.sync);r.set(a,c)})};return O&&O.add(o),u(),o}const j=Symbol();function H(n,s){typeof s=="string"&&(console.warn("[Deprecated] Please use option object instead of name string"),s={name:s});const{enabled:e,name:t=""}=s||{};let r;try{r=(e!=null?e:!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!r)return;let o=!1;const u=r.connect({name:t}),i=S(n,a=>{const c=a.filter(([l,d])=>d[0]!==j).map(([l,d])=>`${l}:${d.map(String).join(".")}`).join(", ");if(c)if(o)o=!1;else{const l=Object.assign({},y(n));delete l[j],u.send({type:c,updatedAt:new Date().toLocaleString()},l)}}),h=u.subscribe(a=>{var c,l,d,p,x,w;if(a.type==="ACTION"&&a.payload)try{Object.assign(n,JSON.parse(a.payload))}catch(v){console.error(`please dispatch a serializable value that JSON.parse() and proxy() support
`,v)}if(a.type==="DISPATCH"&&a.state){if(((c=a.payload)==null?void 0:c.type)==="JUMP_TO_ACTION"||((l=a.payload)==null?void 0:l.type)==="JUMP_TO_STATE"){o=!0;const v=JSON.parse(a.state);Object.assign(n,v)}n[j]=a}else if(a.type==="DISPATCH"&&((d=a.payload)==null?void 0:d.type)==="COMMIT")u.init(y(n));else if(a.type==="DISPATCH"&&((p=a.payload)==null?void 0:p.type)==="IMPORT_STATE"){const v=(x=a.payload.nextLiftedState)==null?void 0:x.actionsById,$=((w=a.payload.nextLiftedState)==null?void 0:w.computedStates)||[];o=!0,$.forEach(({state:B},J)=>{const F=v[J]||"No action found";Object.assign(n,B),J===0?u.init(y(n)):u.send(F,y(n))})}});return u.init(y(n)),()=>{i(),h==null||h()}}const g=new WeakMap,m=new WeakMap,_=(n,s)=>{const e=g.get(n);e&&(e[0].forEach(t=>{const{d:r}=t;n!==r&&_(r)}),++e[2],s&&e[3].add(s))},z=(n,s)=>{const e=g.get(n);return e!=null&&e[2]?(e[3].add(s),!0):!1},T=n=>{const s=g.get(n);s&&(--s[2],s[2]||(s[3].forEach(e=>e()),s[3].clear()),s[0].forEach(e=>{const{d:t}=e;n!==t&&T(t)}))},D=n=>{const{s,d:e}=n;let t=m.get(e);t||(t=[new Set],m.set(n.d,t)),t[0].add(n);let r=g.get(s);if(!r){const o=new Set,u=S(s,i=>{o.forEach(h=>{const{d:a,c,n:l,i:d}=h;s===a&&i.every(p=>p[1].length===1&&d.includes(p[1][0]))||h.p||(_(s,c),l?T(s):h.p=Promise.resolve().then(()=>{delete h.p,T(s)}))})},!0);r=[o,u,0,new Set],g.set(s,r)}r[0].add(n)},P=n=>{const{s,d:e}=n,t=m.get(e);t==null||t[0].delete(n),(t==null?void 0:t[0].size)===0&&m.delete(e);const r=g.get(s);if(r){const[o,u]=r;o.delete(n),o.size||(u(),g.delete(s))}},N=n=>{const s=m.get(n);return s?Array.from(s[0]):[]},q=k("unstable_deriveSubscriptions",{add:D,remove:P,list:N});function I(n,s){const e=(s==null?void 0:s.proxy)||b({}),t=!!(s!=null&&s.sync),r=Object.keys(n);return r.forEach(o=>{if(Object.getOwnPropertyDescriptor(e,o))throw new Error("object property already defined");const u=n[o];let i=null;const h=()=>{if(i&&(Array.from(i).map(([d])=>z(d,h)).some(d=>d)||Array.from(i).every(([d,p])=>E(d)===p.v)))return;const a=new Map,c=u(d=>(a.set(d,{v:E(d)}),d)),l=()=>{a.forEach((d,p)=>{var x;const w=(x=i==null?void 0:i.get(p))==null?void 0:x.s;if(w)d.s=w;else{const v={s:p,d:e,k:o,c:h,n:t,i:r};D(v),d.s=v}}),i==null||i.forEach((d,p)=>{!a.has(p)&&d.s&&P(d.s)}),i=a};c instanceof Promise?c.finally(l):l(),e[o]=c};h()}),e}function R(n,s){const e=s!=null&&s.delete?new Set:null;N(n).forEach(t=>{const{k:r}=t;(!(s!=null&&s.keys)||s.keys.includes(r))&&(P(t),e&&e.add(r))}),e&&e.forEach(t=>{delete n[t]})}function U(n,s,e=n){console.warn("addComputed is deprecated. Please consider using `derive` or `proxyWithComputed` instead. Falling back to emulation with derive.");const t={};return Object.keys(s).forEach(r=>{t[r]=o=>s[r](o(n))}),I(t,{proxy:e})}function L(n,s){Object.keys(s).forEach(t=>{if(Object.getOwnPropertyDescriptor(n,t))throw new Error("object property already defined");const r=s[t],{get:o,set:u}=typeof r=="function"?{get:r}:r;let i,h,a=new WeakMap;const c={};c.get=()=>{const l=y(e);return(!h||A(h,l,a))&&(a=new WeakMap,i=o(M(l,a)),h=l),i},u&&(c.set=l=>u(e,l)),Object.defineProperty(n,t,c)});const e=b(n);return e}function V(n,s=!1){const e=b({value:n,history:C({wip:n,snapshots:[],index:-1}),canUndo:()=>e.history.index>0,undo:()=>{e.canUndo()&&(e.value=e.history.wip=e.history.snapshots[--e.history.index],e.history.snapshots[e.history.index]=y(e).value)},canRedo:()=>e.history.index<e.history.snapshots.length-1,redo:()=>{e.canRedo()&&(e.value=e.history.wip=e.history.snapshots[++e.history.index],e.history.snapshots[e.history.index]=y(e).value)},saveHistory:()=>{e.history.snapshots.splice(e.history.index+1),e.history.snapshots.push(y(e).value),++e.history.index},subscribe:()=>S(e,t=>{t.every(r=>r[1][0]==="value"&&(r[0]!=="set"||r[2]!==e.history.wip))&&e.saveHistory()})});return e.saveHistory(),s||e.subscribe(),e}function K(n){const s=b({data:Array.from(new Set(n)),has(e){return this.data.indexOf(e)!==-1},add(e){let t=!1;return typeof e=="object"&&e!==null&&(t=this.data.indexOf(b(e))!==-1),this.data.indexOf(e)===-1&&!t&&this.data.push(e),this},delete(e){const t=this.data.indexOf(e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},forEach(e){this.data.forEach(t=>{e(t,t,this)})},get[Symbol.toStringTag](){return"Set"},toJSON(){return{}},[Symbol.iterator](){return this.data[Symbol.iterator]()},values(){return this.data.values()},keys(){return this.data.values()},entries(){return new Set(this.data).entries()}});return Object.defineProperties(s,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(s),s}function X(n){const s=b({data:Array.from(n||[]),has(e){return this.data.some(t=>t[0]===e)},set(e,t){const r=this.data.find(o=>o[0]===e);return r?r[1]=t:this.data.push([e,t]),this},get(e){var t;return(t=this.data.find(r=>r[0]===e))==null?void 0:t[1]},delete(e){const t=this.data.findIndex(r=>r[0]===e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return{}},forEach(e){this.data.forEach(t=>{e(t[1],t[0],this)})},keys(){return this.data.map(e=>e[0]).values()},values(){return this.data.map(e=>e[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(s,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(s),s}}}});
